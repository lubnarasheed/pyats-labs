## Step 3. Define your Genie Testbed

Before we get started, we must tell Genie which devices we are running our tests against. This is called a `testbed` file.

For more infromation on PyATS & Genie testbeds, you can refer to the [Topology Documentation](https://pubhub.devnetcloud.com/media/pyats/docs/topology/introduction.html)


1. Generate a testbed file for your simulation

```
[developer@devbox genie_learning_lab]$ virl generate pyats
```


2. Examine the testbed file

```
[developer@devbox genie_learning_lab]$ cat default_testbed.yaml
```

The testbed file is a [YAML](https://en.wikipedia.org/wiki/YAML) (“Yet Another Markup Language”); it is a data serialization format that is designed to be both human-readable and machine-readable. YAML is indentation & white space sensitive. Its syntax maps directly to most common datastructures in Python, such dict, list, str etc.

Your testbed file contains definitions of various things in the environment such as routers, switches, links, external servers, or traffic generators.

As a example to illustrate the above, the NX-OSv router defintion for the newly launched testbed would look like this:

```
devices:
  nx-osv-1: <--- hostname
    alias: nx-osv-1
    os: nxos
    type: NX-OSv
    connections:
      defaults:
        class: unicon.Unicon
      console:
        protocol: telnet
        port: 17040
        ip: 172.25.192.90
```

A more comprehensive testbed sample can be found
  <a href="https://pubhub.devnetcloud.com/media/pyats/docs/topology/schema.html#production-yaml-schema" target="_blank">
    here
  </a>
you should take a few minutes to review some of the additional options that can be configured for a given testbed.


3. The testbed YAML file that was generated above will need a few more edits before it can be used for Genie. Open up the testbed YAML file using any editor and make the changes outlined below:

For device "nx-osv-1":

  * Set the `alias` key to be "uut"
  * Add `tacacs` and `passwords` section as shown below

```
devices:
  nx-osv-1:
    alias: 'uut'     <--- (changed from 'nx-osv-1')
    os: nxos
    type: NX-OSv
    tacacs:
      username: cisco
    passwords:
      tacacs: cisco
      enable: cisco
      line: cisco
```

For device "csr1000v-1":

  * Set the `alias` key to be "helper"
  * Add `tacacs` and `passwords` section as shown below

```
devices:
  csr1000v-1:
    alias: 'helper'  <--- (changed from 'csr1000v-1')
    os: iosxe
    type: CSR1000v
    tacacs:
      username: cisco
    passwords:
      tacacs: cisco
      enable: cisco
      line: cisco
```


More information on the keys changed in the testbed YAML:

1. `alias`: Genie will use the `alias` to refer to devices of the testbed during test execution. This prevents the user from hardcoding the device hostnames everywhere in the script and also encourages reusability of the same script on another topology (where users can mark the devices as uut/helpers in the testbed YAML).

3. `tacacs` and `passwords`: If the device has username/passwords configured, Unicon will need to know what to pass through to the device on a username/password prompt. Those values can be set here.


**NOTE: 
- Find the console IP address for each device within your testbed YAML file. 
- Telnet to both devices in the testbed to ensure they are up and running before proceeding to the next steps.***


#### Next Step: Install Genie Packages
